# Настройка: враги и игрок

Кратко, как настроить в проекте агрессию врагов, зоны атаки и разведение (чтобы враги не наслаивались).

---

## 1. Игрок

### 1.1 Тег
- Выбери объект игрока в иерархии.
- В Inspector → **Tag** выбери **Player** (если нет — создай тег в **Edit → Project Settings → Tags and Layers**).

### 1.2 Коллайдер
- На объекте игрока должен быть любой **Collider 2D** (Box Collider 2D, Capsule Collider 2D и т.п.).
- Нужен, чтобы луч врага «упирался» в игрока и враг понимал, что видит его.

### 1.3 Получение урона
- Добавь на объект игрока компонент **Damageable** (скрипт из папки Enemy).
- В инспекторе задай **Hp** (например 100). Когда враг атакует, будет вызываться `TakeDamage`.

---

## 2. Слой для врагов (для разведения)

Чтобы враги не наслаивались и поиск соседей был быстрее:

1. **Edit → Project Settings → Tags and Layers**.
2. В **Layers** выбери свободный слот (например 6 или 8) и назови его **Enemy**.
3. Сохрани.

Дальше этот слой нужно будет назначить префабу врага и указать в **EnemyAI** (см. ниже).

---

## 3. Префаб врага

### 3.1 Компоненты на корне
- **EnemyInstance** — конфиг можно не ставить в префабе, его подставит спавнер.
- **EnemyAI** — ставится автоматически из-за `RequireComponent`.

### 3.2 Коллайдер
- Добавь на префаб врага любой **Collider 2D** (Circle Collider 2D или Box Collider 2D).
- Нужен для:
  - проверки видимости игрока (луч до игрока);
  - разведения врагов (OverlapCircle ищет соседей по коллайдерам).

### 3.3 Слой (опционально, но желательно)
- В Inspector у **корня префаба** в поле **Layer** выбери **Enemy** (тот, что создали в п.2).
- Тогда в **EnemyAI** можно задать **Separation Enemy Layer = Enemy** — разведение будет быстрее и без лишних проверок.

### 3.4 Разведение
- Параметры разведения задаются в **EnemyConfig** (п.4): Separation Radius, Separation Strength, Separation Enemy Layer. Слой по умолчанию — **Enemy** (если в конфиге выбран Nothing).

---

## 4. Конфиг врага (EnemyConfig)

Создай ScriptableObject: **ПКМ в Project → Create → Enemy → Config**.

- **Prefab** — префаб врага из п.3.
- **Aggression Radius** — дистанция, с которой враг «видит» игрока и бежит к нему (красный круг).
- **Attack Range** — дистанция атаки (сиреневый круг).
- **Separation Radius** — радиус отталкивания от других врагов (жёлтый круг); 0 = выкл.
- **Separation Strength** — сила отталкивания (0 = выкл).
- **Separation Enemy Layer** — слой, на котором ищутся враги для разведения. Если **Nothing**, по умолчанию используется слой **Enemy**.
- **Move Speed**, **Attack Damage**, **Attack Interval** — движение и урон.
- Остальные поля (Display Name, Max Hp, награды) — по желанию.

В инспекторе конфига в превью видны три круга в реальном времени: красный — агрессия, сиреневый — атака, жёлтый — разведение. В сцене при выборе врага те же круги + ручки для изменения Aggression и Separation радиусов.

---

## 5. Спавн врагов

### Вариант A: через EnemySpawner
- Создай в сцене пустой объект, добавь **EnemySpawner**.
- Добавь дочерние объекты — это точки спавна (их позиции = центр зоны).
- В **Enemy Spawner**:
  - **Radius** — радиус вокруг каждой точки, в котором появляются враги.
  - **Spawnable Types** — список конфигов врагов.
  - При желании настрой **Point Settings** (количество, радиус и типы для каждой точки).
- При старте сцены враги появятся у точек; **EnemyAI.SetSpawnArea** вызовется автоматически.

### Вариант B: враг уже в сцене
- Поставь префаб врага в сцену, в **EnemyInstance** назначь **Config**.
- Зону «дома» нужно задать скриптом: где-то при старте вызови у этого врага `GetComponent<EnemyAI>().SetSpawnArea(center, radius)` (например center = позиция точки, radius = 2).

---

## 6. Поведение в игре

- Игрок заходит в **красный круг** (Aggression Radius) и не закрыт стеной → враг бежит к игроку.
- Игрок в **сиреневом круге** (Attack Range) → враг наносит урон по таймеру (Attack Interval).
- Игрок вышел из красного круга или за стеной → враг возвращается в зону спавна и бродит там.
- Враги в радиусе **Separation Radius** отталкиваются друг от друга и не наслаиваются.

---

## 7. Проверка в редакторе

- **Gizmos** в окне Scene включены → у всех врагов в сцене видны красный (агрессия) и сиреневый (атака) круги, даже без выбора объекта.
- Выбери врага в иерархии → в сцене рисуются те же круги + можно тянуть радиус агрессии ручкой (Radius Handle).
- В инспекторе **EnemyConfig** в блоке AI видно превью с теми же двумя кругами.

Если что-то не срабатывает, проверь: у игрока тег **Player** и есть Collider2D; у префаба врага есть Collider2D; у врага в сцене задан конфиг или спавнер вызывает SetSpawnArea.
